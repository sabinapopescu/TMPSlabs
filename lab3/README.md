# Laboratory Work Report â€“ Behavioral Design Patterns

## Topic: Behavioral Design Patterns
## Author: Popescu Sabina
## Supervisor: Grigore Guzun
## Course: TMPS â€“ Software Design Techniques
## Lab Nr.: 3 â€“ Behavioral Design Patterns (Bloomify â€“ Communication & Logic Layer)

## 1. Introduction / Motivation
This laboratory work continues the Bloomify project and focuses on behavioral patternsâ€”Strategy, Observer, and Chain of Responsibilityâ€”to define how system components communicate and coordinate. These patterns enable dynamic pricing, event-driven updates, and pluggable validation workflows.

## 2. Theory â€“ Behavioral Design Patterns
Behavioral patterns describe communication between software entities.

### Implemented patterns:
- **Strategy** â€“ interchangeable pricing algorithms  
- **Observer** â€“ event-based notification system  
- **Chain of Responsibility** â€“ ordered validation pipeline  

## 3. System Description
Enhancements added:
- dynamic pricing strategies  
- order and config event observers  
- chain-based validation logic  

## 4. Project Structure

```
bloomify-enhanced/
â”‚
â”œâ”€â”€ ğŸ“„ README.md                    # Comprehensive documentation
â”œâ”€â”€ ğŸ“„ SETUP.md                     # Quick start guide
â”œâ”€â”€ ğŸ“„ CHANGELOG.md                 # List of all improvements
â”œâ”€â”€ ğŸ“„ package.json                 # NPM dependencies and scripts
â”œâ”€â”€ ğŸ“„ tsconfig.json                # TypeScript configuration
â”œâ”€â”€ ğŸ“„ .gitignore                   # Git ignore rules
â”‚
â”œâ”€â”€ ğŸ“ public/                      # Static web files
â”‚   â”œâ”€â”€ ğŸ“„ index.html              # Main HTML (Enhanced UI)
â”‚   â”œâ”€â”€ ğŸ“„ styles.css              # Modern, responsive CSS
â”‚   â””â”€â”€ ğŸ“ js/                     # Compiled JavaScript (generated by tsc)
â”‚       â”œâ”€â”€ ğŸ“ client/
â”‚       â”‚   â””â”€â”€ ğŸ“„ main.js         # Compiled from src/client/main.ts
â”‚       â”œâ”€â”€ ğŸ“ domain/
â”‚       â”‚   â”œâ”€â”€ ğŸ“„ Config.js
â”‚       â”‚   â”œâ”€â”€ ğŸ“„ BouquetBuilder.js
â”‚       â”‚   â””â”€â”€ ğŸ“„ BouquetPrototype.js
â”‚       â”œâ”€â”€ ğŸ“ factory/
â”‚       â”‚   â”œâ”€â”€ ğŸ“„ Payment.js
â”‚       â”‚   â””â”€â”€ ğŸ“„ PaymentFactory.js
â”‚       â”œâ”€â”€ ğŸ“ models/
â”‚       â”‚   â”œâ”€â”€ ğŸ“„ Bouquet.js
â”‚       â”‚   â”œâ”€â”€ ğŸ“„ Flower.js
â”‚       â”‚   â””â”€â”€ ğŸ“„ Customer.js
â”‚       â””â”€â”€ ğŸ“ pool/
â”‚           â””â”€â”€ ğŸ“„ ConnectionPool.js
â”‚
â””â”€â”€ ğŸ“ src/                         # TypeScript source files
    â”‚
    â”œâ”€â”€ ğŸ“ client/                  # UI Integration Layer
    â”‚   â””â”€â”€ ğŸ“„ main.ts             # Main application logic
    â”‚                                â€¢ Event handlers
    â”‚                                â€¢ DOM manipulation
    â”‚                                â€¢ Validation logic
    â”‚                                â€¢ Toast notifications
    â”‚
    â”œâ”€â”€ ğŸ“ domain/                  # Design Pattern Implementations
    â”‚   â”‚
    â”‚   â”œâ”€â”€ ğŸ“„ Config.ts           # ğŸ”· Singleton Pattern
    â”‚   â”‚                            â€¢ Global configuration
    â”‚   â”‚                            â€¢ Currency management
    â”‚   â”‚                            â€¢ Locale settings
    â”‚   â”‚                            â€¢ LocalStorage persistence
    â”‚   â”‚
    â”‚   â”œâ”€â”€ ğŸ“„ BouquetBuilder.ts   # ğŸ”· Builder Pattern
    â”‚   â”‚                            â€¢ Step-by-step construction
    â”‚   â”‚                            â€¢ Fluent interface
    â”‚   â”‚                            â€¢ Validation rules
    â”‚   â”‚                            â€¢ Reset functionality
    â”‚   â”‚
    â”‚   â””â”€â”€ ğŸ“„ BouquetPrototype.ts # ğŸ”· Prototype Pattern
    â”‚                                â€¢ Template cloning
    â”‚                                â€¢ Pre-configured bouquets
    â”‚                                â€¢ Deep copy implementation
    â”‚
    â”œâ”€â”€ ğŸ“ factory/                 # Factory Pattern
    â”‚   â”‚
    â”‚   â”œâ”€â”€ ğŸ“„ Payment.ts          # Payment Implementations
    â”‚   â”‚                            â€¢ CardPayment class
    â”‚   â”‚                            â€¢ CryptoPayment class
    â”‚   â”‚                            â€¢ BankTransferPayment class
    â”‚   â”‚                            â€¢ Validation methods
    â”‚   â”‚
    â”‚   â””â”€â”€ ğŸ“„ PaymentFactory.ts   # ğŸ”· Factory Method Pattern
    â”‚                                â€¢ PaymentCreator abstract class
    â”‚                                â€¢ SimplePaymentCreator implementation
    â”‚                                â€¢ EnhancedPaymentCreator (with logging)
    â”‚
    â”œâ”€â”€ ğŸ“ models/                  # Data Models
    â”‚   â”‚
    â”‚   â”œâ”€â”€ ğŸ“„ Bouquet.ts          # Bouquet Entity
    â”‚   â”‚                            â€¢ Price calculation
    â”‚   â”‚                            â€¢ Clone support
    â”‚   â”‚                            â€¢ JSON serialization
    â”‚   â”‚                            â€¢ Validation
    â”‚   â”‚
    â”‚   â”œâ”€â”€ ğŸ“„ Flower.ts           # Flower Entity
    â”‚   â”‚                            â€¢ Properties (kind, color, price)
    â”‚   â”‚                            â€¢ Emoji mapping
    â”‚   â”‚                            â€¢ Price range validation
    â”‚   â”‚
    â”‚   â””â”€â”€ ğŸ“„ Customer.ts         # Customer Entity
    â”‚                                â€¢ Name and email
    â”‚                                â€¢ Email validation
    â”‚                                â€¢ Privacy features
    â”‚
    â””â”€â”€ ğŸ“ pool/                    # Object Pool Pattern
        â”‚
        â””â”€â”€ ğŸ“„ ConnectionPool.ts   # ğŸ”· Object Pool Pattern (Bonus)
                                     â€¢ Connection reuse
                                     â€¢ Resource management
                                     â€¢ Statistics tracking
                                     â€¢ Singleton wrapper

```

## ğŸ¯ Design Patterns Map

| Pattern | File | Purpose |
|---------|------|---------|
| ğŸ”· **Singleton** | `Config.ts` | Single instance for global configuration |
| ğŸ”· **Builder** | `BouquetBuilder.ts` | Step-by-step object construction |
| ğŸ”· **Prototype** | `BouquetPrototype.ts` | Clone pre-configured objects |
| ğŸ”· **Factory Method** | `PaymentFactory.ts` | Create payment objects polymorphically |
| ğŸ”· **Object Pool** | `ConnectionPool.ts` | Reuse expensive resources |

## ğŸ”„ Data Flow

```
1. User Input (HTML Forms)
   â†“
2. Event Handlers (main.ts)
   â†“
3. Validation (main.ts)
   â†“
4. Pattern Classes (domain/, factory/)
   â†“
5. Domain Models (models/)
   â†“
6. Configuration (Config singleton)
   â†“
7. DOM Update (main.ts)
   â†“
8. User Feedback (Toast, Preview)
```

## ğŸ“¦ Build Process

```
TypeScript Source Files (src/)
         â†“
    TypeScript Compiler (tsc)
         â†“
JavaScript Output (public/js/)
         â†“
    Web Server (http-server)
         â†“
   Browser (localhost:3000)
```

## ğŸ“ Pattern Interaction Example

```typescript
// 1. Singleton provides configuration
const config = Config.getInstance(); // Singleton

// 2. Builder constructs bouquet
const builder = new BouquetBuilder(); // Builder
const bouquet = builder
  .setName("Love Bouquet")
  .addFlower("Rose", "Red", 3.0, 12)
  .build();

// 3. Prototype clones template
const template = BouquetTemplate.presets().valentine; // Prototype
const cloned = template.clone();

// 4. Factory creates payment
const factory = new SimplePaymentCreator(); // Factory
const payment = factory.create({ type: "card", masked: "1234" });

// 5. Pool manages connections
const pool = ConnectionPool.getInstance(); // Pool + Singleton
const conn = pool.acquire();
```

---

**Legend:**
- ğŸ“ = Directory
- ğŸ“„ = File
- ğŸ”· = Design Pattern Implementation


## 5. Implementation & Explanation

### Strategy Pattern
Files:
```
src/domain/pricing/IPricingStrategy.ts
src/domain/pricing/DefaultPricingStrategy.ts
src/domain/pricing/HolidayPricingStrategy.ts
src/domain/pricing/LoyaltyPricingStrategy.ts
src/domain/pricing/PricingContext.ts
```

The Strategy pattern allows switching pricing algorithms at runtime.

### Observer Pattern
Files:
```
src/domain/events/IObservable.ts
src/domain/events/IObserver.ts
src/domain/events/ConfigObservable.ts
src/domain/events/OrderStatusObservable.ts
src/domain/events/observers/
```

Used for config change events and order status updates.

### Chain of Responsibility
Files:
```
src/domain/validation/
  IOrderValidator.ts
  BaseOrderValidator.ts
  StockValidator.ts
  PaymentValidator.ts
  DeliveryAreaValidator.ts
  MinTotalValidator.ts
  OrderValidationPipeline.ts
```

Implements a modular validation workflow.

## 6. Files Added / Modified
- Entire behavioral layer added under `/domain/pricing`, `/domain/events`, `/domain/validation`.
- Facade extended to use strategies and validation pipeline.
- Client updated to subscribe to observers.

## 7. Difficulties Encountered
- Avoiding complex Facade logic  
- Designing clean Strategy interfaces  
- Managing Observer subscriptions  
- Ordering validators in a safe way  
- TypeScript typing issues  

## 8. Results / Conclusions
The project now:
- supports dynamic pricing  
- reacts to configuration and order updates  
- validates orders through a clean pipeline  
- maintains a single client and proper modular structure  

All lab requirements are fulfilled.
